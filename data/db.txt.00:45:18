[ DB LOG -- 00:45:18 ]

[ Query Time ]

Count: 80  Time=3.37s (269s)  Lock=0.00s (0s)  Rows=14.7 (1178), isucon[isucon]@localhost
  SELECT name, data FROM image WHERE name = 'S'

Count: 1129  Time=0.02s (25s)  Lock=0.00s (0s)  Rows=1.0 (1129), isucon[isucon]@localhost
  SELECT COUNT(*) as cnt FROM message WHERE channel_id = N

Count: 16044  Time=0.00s (23s)  Lock=0.00s (0s)  Rows=0.8 (12701), 2users@localhost
  #

Count: 4911  Time=0.00s (14s)  Lock=0.00s (2s)  Rows=1.0 (4911), isucon[isucon]@localhost
  SELECT name, display_name, avatar_icon FROM user WHERE id = N

Count: 39  Time=0.23s (8s)  Lock=0.00s (0s)  Rows=5.4 (209), isucon[isucon]@localhost
  SELECT * FROM message WHERE channel_id = N ORDER BY id DESC LIMIT N OFFSET N

Count: 61  Time=0.10s (6s)  Lock=0.00s (0s)  Rows=77.1 (4702), isucon[isucon]@localhost
  SELECT * FROM message WHERE id > N AND channel_id = N ORDER BY id DESC LIMIT N

Count: 16  Time=0.08s (1s)  Lock=0.19s (3s)  Rows=0.0 (0), isucon[isucon]@localhost
  INSERT INTO image (name, data) VALUES ('S', 'S')

Count: 125  Time=0.01s (1s)  Lock=0.00s (0s)  Rows=100.0 (12500), isucon[isucon]@localhost
  SELECT * FROM channel ORDER BY id

Count: 241  Time=0.00s (0s)  Lock=0.00s (0s)  Rows=1.0 (236), isucon[isucon]@localhost
  SELECT * FROM user WHERE name = 'S'

Count: 1100  Time=0.00s (0s)  Lock=0.00s (0s)  Rows=0.0 (10), isucon[isucon]@localhost
  SELECT * FROM haveread WHERE user_id = N AND channel_id = N

Count: 49  Time=0.01s (0s)  Lock=0.00s (0s)  Rows=0.0 (0), isucon[isucon]@localhost
  INSERT INTO haveread (user_id, channel_id, message_id, updated_at, created_at) VALUES (N, N, N, NOW(), NOW()) ON DUPLICATE KEY UPDATE message_id = N, updated_at = NOW()

Count: 236  Time=0.00s (0s)  Lock=0.00s (0s)  Rows=1.0 (236), isucon[isucon]@localhost
  SELECT * FROM user WHERE id = N

Count: 20  Time=0.01s (0s)  Lock=0.00s (0s)  Rows=0.0 (0), isucon[isucon]@localhost
  INSERT INTO user (name, salt, password, display_name, avatar_icon, created_at) VALUES ('S', 'S', 'S', 'S', 'S', NOW())

Count: 16  Time=0.02s (0s)  Lock=0.00s (0s)  Rows=0.0 (0), isucon[isucon]@localhost
  UPDATE user SET avatar_icon = 'S' WHERE id = N

Count: 16  Time=0.01s (0s)  Lock=0.00s (0s)  Rows=0.0 (0), isucon[isucon]@localhost
  UPDATE user SET display_name = 'S' WHERE id = N

Count: 23  Time=0.01s (0s)  Lock=0.00s (0s)  Rows=1.0 (23), isucon[isucon]@localhost
  SELECT @@max_allowed_packet

Count: 90  Time=0.00s (0s)  Lock=0.00s (0s)  Rows=0.0 (0), isucon[isucon]@localhost
  INSERT INTO channel (name, description, updated_at, created_at) VALUES ('S', 'S', NOW(), NOW())

Count: 23  Time=0.00s (0s)  Lock=0.00s (0s)  Rows=0.0 (0), isucon[isucon]@localhost
  SET NAMES utf8mb4

Count: 1  Time=0.02s (0s)  Lock=0.00s (0s)  Rows=0.0 (0), isucon[isucon]@localhost
  DELETE FROM image WHERE id > N

Count: 11  Time=0.00s (0s)  Lock=0.00s (0s)  Rows=100.0 (1100), isucon[isucon]@localhost
  SELECT id FROM channel

Count: 10  Time=0.00s (0s)  Lock=0.00s (0s)  Rows=1.0 (10), isucon[isucon]@localhost
  SELECT COUNT(*) as cnt FROM message WHERE channel_id = N AND N < id

Count: 1  Time=0.01s (0s)  Lock=0.05s (0s)  Rows=0.0 (0), isucon[isucon]@localhost
  DELETE FROM user WHERE id > N

Count: 1  Time=0.01s (0s)  Lock=0.00s (0s)  Rows=0.0 (0), isucon[isucon]@localhost
  DELETE FROM haveread

Count: 1  Time=0.00s (0s)  Lock=0.00s (0s)  Rows=0.0 (0), isucon[isucon]@localhost
  INSERT INTO message (channel_id, user_id, content, created_at) VALUES (N, N, 'S', NOW())

Count: 1  Time=0.00s (0s)  Lock=0.00s (0s)  Rows=0.0 (0), isucon[isucon]@localhost
  DELETE FROM channel WHERE id > N

Count: 1  Time=0.00s (0s)  Lock=0.00s (0s)  Rows=0.0 (0), isucon[isucon]@localhost
  DELETE FROM message WHERE id > N

Count: 8015  Time=0.00s (0s)  Lock=0.00s (0s)  Rows=0.0 (0), 0users@0hosts
  administrator command: Prepare

Count: 1  Time=0.00s (0s)  Lock=0.00s (0s)  Rows=0.0 (0), 0users@0hosts
  administrator command: Ping

Count: 8015  Time=0.00s (0s)  Lock=0.00s (0s)  Rows=0.0 (0), 0users@0hosts
  administrator command: Close stmt

Count: 13  Time=0.00s (0s)  Lock=0.00s (0s)  Rows=0.0 (0), 0users@0hosts
  administrator command: Quit

[ TOP Query Count ]

Count: 80  Time=3.37s (269s)  Lock=0.00s (0s)  Rows=14.7 (1178), isucon[isucon]@localhost
  SELECT name, data FROM image WHERE name = 'S'

Count: 1129  Time=0.02s (25s)  Lock=0.00s (0s)  Rows=1.0 (1129), isucon[isucon]@localhost
  SELECT COUNT(*) as cnt FROM message WHERE channel_id = N

Count: 16044  Time=0.00s (23s)  Lock=0.00s (0s)  Rows=0.8 (12701), 2users@localhost
  #

Count: 4911  Time=0.00s (14s)  Lock=0.00s (2s)  Rows=1.0 (4911), isucon[isucon]@localhost
  SELECT name, display_name, avatar_icon FROM user WHERE id = N

Count: 39  Time=0.23s (8s)  Lock=0.00s (0s)  Rows=5.4 (209), isucon[isucon]@localhost
  SELECT * FROM message WHERE channel_id = N ORDER BY id DESC LIMIT N OFFSET N

Count: 61  Time=0.10s (6s)  Lock=0.00s (0s)  Rows=77.1 (4702), isucon[isucon]@localhost
  SELECT * FROM message WHERE id > N AND channel_id = N ORDER BY id DESC LIMIT N

Count: 16  Time=0.08s (1s)  Lock=0.19s (3s)  Rows=0.0 (0), isucon[isucon]@localhost
  INSERT INTO image (name, data) VALUES ('S', 'S')



[ TOP Query AVG ]

Count: 80  Time=3.37s (269s)  Lock=0.00s (0s)  Rows=14.7 (1178), isucon[isucon]@localhost
  SELECT name, data FROM image WHERE name = 'S'

Count: 39  Time=0.23s (8s)  Lock=0.00s (0s)  Rows=5.4 (209), isucon[isucon]@localhost
  SELECT * FROM message WHERE channel_id = N ORDER BY id DESC LIMIT N OFFSET N

Count: 61  Time=0.10s (6s)  Lock=0.00s (0s)  Rows=77.1 (4702), isucon[isucon]@localhost
  SELECT * FROM message WHERE id > N AND channel_id = N ORDER BY id DESC LIMIT N

Count: 16  Time=0.08s (1s)  Lock=0.19s (3s)  Rows=0.0 (0), isucon[isucon]@localhost
  INSERT INTO image (name, data) VALUES ('S', 'S')

Count: 1129  Time=0.02s (25s)  Lock=0.00s (0s)  Rows=1.0 (1129), isucon[isucon]@localhost
  SELECT COUNT(*) as cnt FROM message WHERE channel_id = N

Count: 1  Time=0.02s (0s)  Lock=0.00s (0s)  Rows=0.0 (0), isucon[isucon]@localhost
  DELETE FROM image WHERE id > N

Count: 16  Time=0.02s (0s)  Lock=0.00s (0s)  Rows=0.0 (0), isucon[isucon]@localhost
  UPDATE user SET avatar_icon = 'S' WHERE id = N



