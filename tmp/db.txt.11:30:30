========== mysqldumpslow ==========

[ DB LOG -- 11:30:30(isucon7-1) ]

[(1) Top 5 Query Time ]

Count: 1358  Time=1.11s (1503s)  Lock=0.00s (0s)  Rows=16.2 (21972), isucon[isucon]@localhost
  SELECT * FROM image WHERE name = 'S'

Count: 86768  Time=0.00s (288s)  Lock=0.00s (3s)  Rows=1.0 (86768), isucon[isucon]@localhost
  SELECT COUNT(*) as cnt FROM message WHERE channel_id = N

Count: 87623  Time=0.00s (13s)  Lock=0.00s (5s)  Rows=0.0 (874), isucon[isucon]@localhost
  SELECT * FROM haveread WHERE user_id = N AND channel_id = N

Count: 874  Time=0.00s (3s)  Lock=0.00s (0s)  Rows=1.0 (874), isucon[isucon]@localhost
  SELECT COUNT(*) as cnt FROM message WHERE channel_id = N AND N < id

Count: 892  Time=0.00s (1s)  Lock=0.00s (0s)  Rows=0.0 (0), isucon[isucon]@localhost
  INSERT INTO haveread (user_id, channel_id, message_id, updated_at, created_at) VALUES (N, N, N, NOW(), NOW()) ON DUPLICATE KEY UPDATE message_id = N, updated_at = NOW()

[(2) TOP 5 Query AVG ]

Count: 1401  Time=1.12s (1564s)  Lock=0.00s (0s)  Rows=16.2 (22671), isucon[isucon]@localhost
  SELECT * FROM image WHERE name = 'S'

Count: 4  Time=0.04s (0s)  Lock=0.05s (0s)  Rows=0.0 (0), isucon[isucon]@localhost
  INSERT INTO image (name, data) VALUES ('S', _binary 'S')

Count: 18  Time=0.03s (0s)  Lock=0.00s (0s)  Rows=9.4 (169), isucon[isucon]@localhost
  SELECT * FROM message WHERE channel_id = N ORDER BY id DESC LIMIT N OFFSET N

Count: 1  Time=0.01s (0s)  Lock=0.00s (0s)  Rows=10.0 (10), isucon[isucon]@fp276e857c.stmb106.ap.nuro.jp
  SELECT channel_id,COUNT(*) cnd FROM message GROUP BY channel_id

Count: 1  Time=0.01s (0s)  Lock=0.00s (0s)  Rows=100.0 (100), isucon[isucon]@fp276e857c.stmb106.ap.nuro.jp
  SELECT id,cnt FROM channel
  LEFT JOIN (



[(3) TOP 5 Query Count ]

Count: 87623  Time=0.00s (13s)  Lock=0.00s (5s)  Rows=0.0 (874), isucon[isucon]@localhost
  SELECT * FROM haveread WHERE user_id = N AND channel_id = N

Count: 86768  Time=0.00s (288s)  Lock=0.00s (3s)  Rows=1.0 (86768), isucon[isucon]@localhost
  SELECT COUNT(*) as cnt FROM message WHERE channel_id = N

Count: 4571  Time=0.00s (1s)  Lock=0.00s (0s)  Rows=1.0 (4571), isucon[isucon]@localhost
  SELECT name, display_name, avatar_icon FROM user WHERE id = N

Count: 3586  Time=0.00s (0s)  Lock=0.00s (0s)  Rows=8.5 (30399), isucon[isucon]@2hosts
  #

Count: 3584  Time=0.00s (0s)  Lock=0.00s (0s)  Rows=0.0 (0), 0users@0hosts
  administrator command: Quit




========== pt-query-digest ==========


# 28.2s user time, 130ms system time, 63.16M rss, 117.67M vsz
# Current date: Sat Nov 14 11:31:09 2020
# Hostname: isucon7-1
# Files: /var/log/mysql/slow.log

# 28.2s user time, 140ms system time, 63.33M rss, 117.67M vsz
# Current date: Sat Nov 14 11:31:09 2020
# Hostname: isucon7-1
# Files: /var/log/mysql/slow.log

# 28.3s user time, 140ms system time, 63.33M rss, 117.67M vsz
# Current date: Sat Nov 14 11:31:09 2020
# Hostname: isucon7-1
# Files: /var/log/mysql/slow.log
